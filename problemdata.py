import numpy as np
import sys
np.set_printoptions(threshold=sys.maxsize)
Action_space = np.array([1, 2, 3, 4]) # right, down, left, upward
R = np.array([100, -10]) # reward space
xmax = 9   # maximum separation in x coordinate
ymax = 9   # maximum separation in y coordinate
State_space = np.array((xmax + 1, ymax + 1))   # state space
TPMcl = np.zeros((4, (xmax + 1) * (ymax + 1),  (xmax + 1) * (ymax + 1)))   # TPM for clockwise orientation
TPMacl = np.zeros((4, (xmax + 1) * (ymax + 1),  (xmax + 1) * (ymax + 1)))   # TPM for anticlockwise orientation
# the transition from clockwise to anticlockwise can only happen if either one or both x and y separation goes to 0
TPMdummy = np.zeros((4, (xmax + 1) * (ymax + 1),  (xmax + 1) * (ymax + 1)))     # a dummy TPM to store the probability of transition when either one of the coordinate (either x or y) or both goes to 0
for a in range(4):
    if a == 0:   # TPM for action right
        for i in range((xmax + 1) * (ymax + 1)):
            if i == 0:  # Example 00
                TPMcl[a][i][i] = 0.5
                TPMdummy[a][i][i] = 0.5
            elif i == (xmax + 1) * (ymax + 1) - 1:  # Example 99
                TPMcl[a][i][i] = 0.15
                TPMcl[a][i][((i // 10) - 1) * 10 + (i % 10)] = 0.75
                TPMcl[a][i][(i // 10) * 10 + (i % 10) - 1] = 0.1
            elif (i // 10 == xmax) and (i % 10 != ymax) and (i % 10 != 0):  # Example 97
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.75
            elif (i // 10 == xmax) and (i % 10 == 0):  # Example 90
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.025
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.375
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
            elif (i // 10 == 0) and (i % 10 == xmax):  # Example 09
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
            elif (i // 10 == 0) and (i % 10 != ymax) and (i % 10 != 0):  # Example 07
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.05
            elif (i // 10 != 0) and (i // 10 != xmax) and (i % 10 != 0) and (i % 10 != xmax):  # Example 12
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.75
            elif (i % 10 == 0) and (i // 10 != 0) and (i // 10 != xmax):  # Example 80
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.025
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.375
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
            elif (i % 10 == xmax) and (i // 10 != 0) and (i // 10 != xmax):  # Example 59
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.75
        for i in range((xmax + 1) * (ymax + 1)):
            if i == 0:  # Example 00
                TPMacl[a][i][i] = 0.5
                TPMdummy[a][i][i] = 0.5
            elif i == (xmax + 1) * (ymax + 1) - 1:  # Example 99
                TPMacl[a][i][i] = 0.8
                TPMacl[a][i][((i // 10) - 1) * 10 + (i % 10)] = 0.1
                TPMacl[a][i][(i // 10) * 10 + (i % 10) - 1] = 0.1
            elif (i // 10 == xmax) and (i % 10 != ymax) and (i % 10 != 0):  # Example 97
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.75
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
            elif (i // 10 == xmax) and (i % 10 == 0):  # Example 90
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.375
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.025
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
            elif (i // 10 == 0) and (i % 10 == xmax):  # Example 09
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
            elif (i // 10 == 0) and (i % 10 != ymax) and (i % 10 != 0):  # Example 07
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.05
            elif (i // 10 != 0) and (i // 10 != xmax) and (i % 10 != 0) and (i % 10 != xmax):  # Example 12
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.75
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
            elif (i % 10 == 0) and (i // 10 != 0) and (i // 10 != xmax):  # Example 80
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.375
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.025
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
            elif (i % 10 == xmax) and (i // 10 != 0) and (i // 10 != xmax):  # Example 59
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.75
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
    if a == 1:  # TPM for action down
        for i in range((xmax + 1) * (ymax + 1)):
            if i == 0:  # Example 00
                TPMcl[a][i][i] = 0.5
                TPMdummy[a][i][i] = 0.5
            elif i == (xmax + 1) * (ymax + 1) - 1:  # Example 99
                TPMcl[a][i][i] = 0.85
                TPMcl[a][i][((i // 10) - 1) * 10 + (i % 10)] = 0.1
                TPMcl[a][i][(i // 10) * 10 + (i % 10) - 1] = 0.05
            elif (i // 10 == xmax) and (i % 10 != ymax) and (i % 10 != 0):  # Example 97
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.75
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.1
            elif (i // 10 == xmax) and (i % 10 == 0):  # Example 90
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
            elif (i // 10 == 0) and (i % 10 == xmax):  # Example 09
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.025
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.375
            elif (i // 10 == 0) and (i % 10 != ymax) and (i % 10 != 0):  # Example 07
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.025
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.375
            elif (i // 10 != 0) and (i // 10 != xmax) and (i % 10 != 0) and (i % 10 != xmax):  # Example 12
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.75
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.1
            elif (i % 10 == 0) and (i // 10 != 0) and (i // 10 != xmax):  # Example 80
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
            elif (i % 10 == xmax) and (i // 10 != 0) and (i // 10 != xmax):  # Example 59
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.75
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.1
        for i in range((xmax + 1) * (ymax + 1)):
            if i == 0:  # Example 00
                TPMacl[a][i][i] = 0.5
                TPMdummy[a][i][i] = 0.5
            elif i == (xmax + 1) * (ymax + 1) - 1:  # Example 99
                TPMacl[a][i][i] = 0.15
                TPMacl[a][i][((i // 10) - 1) * 10 + (i % 10)] = 0.1
                TPMacl[a][i][(i // 10) * 10 + (i % 10) - 1] = 0.75
            elif (i // 10 == xmax) and (i % 10 != ymax) and (i % 10 != 0):  # Example 97
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.75
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.1
            elif (i // 10 == xmax) and (i % 10 == 0):  # Example 90
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
            elif (i // 10 == 0) and (i % 10 == xmax):  # Example 09
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.375
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.025
            elif (i // 10 == 0) and (i % 10 != ymax) and (i % 10 != 0):  # Example 07
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.375
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.025
            elif (i // 10 != 0) and (i // 10 != xmax) and (i % 10 != 0) and (i % 10 != xmax):  # Example 12
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.75
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.1
            elif (i % 10 == 0) and (i // 10 != 0) and (i // 10 != xmax):  # Example 80
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
            elif (i % 10 == xmax) and (i // 10 != 0) and (i // 10 != xmax):  # Example 59
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.75
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.1
    if a == 2:  # TPM for action left
        for i in range((xmax + 1) * (ymax + 1)):
            if i == 0:  # Example 00
                TPMcl[a][i][i] = 0.5
                TPMdummy[a][i][i] = 0.5
            elif i == (xmax + 1) * (ymax + 1) - 1:  # Example 99
                TPMcl[a][i][i] = 0.8
                TPMcl[a][i][((i // 10) - 1) * 10 + (i % 10)] = 0.1
                TPMcl[a][i][(i // 10) * 10 + (i % 10) - 1] = 0.1
            elif (i // 10 == xmax) and (i % 10 != ymax) and (i % 10 != 0):  # Example 97
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.75
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
            elif (i // 10 == xmax) and (i % 10 == 0):  # Example 90
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.375
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.025
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
            elif (i // 10 == 0) and (i % 10 == xmax):  # Example 09
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
            elif (i // 10 == 0) and (i % 10 != ymax) and (i % 10 != 0):  # Example 07
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.05
            elif (i // 10 != 0) and (i // 10 != xmax) and (i % 10 != 0) and (i % 10 != xmax):  # Example 12
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.75
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
            elif (i % 10 == 0) and (i // 10 != 0) and (i // 10 != xmax):  # Example 80
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.375
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.025
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
            elif (i % 10 == xmax) and (i // 10 != 0) and (i // 10 != xmax):  # Example 59
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.75
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
        for i in range((xmax + 1) * (ymax + 1)):
            if i == 0:  # Example 00
                TPMacl[a][i][i] = 0.5
                TPMdummy[a][i][i] = 0.5
            elif i == (xmax + 1) * (ymax + 1) - 1:  # Example 99
                TPMacl[a][i][i] = 0.15
                TPMacl[a][i][((i // 10) - 1) * 10 + (i % 10)] = 0.75
                TPMacl[a][i][(i // 10) * 10 + (i % 10) - 1] = 0.1
            elif (i // 10 == xmax) and (i % 10 != ymax) and (i % 10 != 0):  # Example 97
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.75
            elif (i // 10 == xmax) and (i % 10 == 0):  # Example 90
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.025
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.375
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
            elif (i // 10 == 0) and (i % 10 == xmax):  # Example 09
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
            elif (i // 10 == 0) and (i % 10 != ymax) and (i % 10 != 0):  # Example 07
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.05
            elif (i // 10 != 0) and (i // 10 != xmax) and (i % 10 != 0) and (i % 10 != xmax):  # Example 12
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.75
            elif (i % 10 == 0) and (i // 10 != 0) and (i // 10 != xmax):  # Example 80
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.025
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.375
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.1
            elif (i % 10 == xmax) and (i // 10 != 0) and (i // 10 != xmax):  # Example 59
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.75
    if a == 3:   # TPM for action up
        for i in range((xmax + 1) * (ymax + 1)):
            if i == 0:  # Example 00
                TPMcl[a][i][i] = 0.5
                TPMdummy[a][i][i] = 0.5
            elif i == (xmax + 1) * (ymax + 1) - 1:  # Example 99
                TPMcl[a][i][i] = 0.15
                TPMcl[a][i][((i // 10) - 1) * 10 + (i % 10)] = 0.1
                TPMcl[a][i][(i // 10) * 10 + (i % 10) - 1] = 0.75
            elif (i // 10 == xmax) and (i % 10 != ymax) and (i % 10 != 0):  # Example 97
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.75
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.1
            elif (i // 10 == xmax) and (i % 10 == 0):  # Example 90
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
            elif (i // 10 == 0) and (i % 10 == xmax):  # Example 09
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.375
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.025
            elif (i // 10 == 0) and (i % 10 != ymax) and (i % 10 != 0):  # Example 07
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.375
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.025
            elif (i // 10 != 0) and (i // 10 != xmax) and (i % 10 != 0) and (i % 10 != xmax):  # Example 12
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.75
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.1
            elif (i % 10 == 0) and (i // 10 != 0) and (i // 10 != xmax):  # Example 80
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
            elif (i % 10 == xmax) and (i // 10 != 0) and (i // 10 != xmax):  # Example 59
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.75
                TPMcl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMcl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.1
        for i in range((xmax + 1) * (ymax + 1)):
            if i == 0:  # Example 00
                TPMacl[a][i][i] = 0.5
                TPMdummy[a][i][i] = 0.5
            elif i == (xmax + 1) * (ymax + 1) - 1:  # Example 99
                TPMacl[a][i][i] = 0.85
                TPMacl[a][i][((i // 10) - 1) * 10 + (i % 10)] = 0.1
                TPMacl[a][i][(i // 10) * 10 + (i % 10) - 1] = 0.05
            elif (i // 10 == xmax) and (i % 10 != ymax) and (i % 10 != 0):  # Example 97
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.75
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.1
            elif (i // 10 == xmax) and (i % 10 == 0):  # Example 90
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
            elif (i // 10 == 0) and (i % 10 == xmax):  # Example 09
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.025
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.375
            elif (i // 10 == 0) and (i % 10 != ymax) and (i % 10 != 0):  # Example 07
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.025
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.375
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.025
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.375
            elif (i // 10 != 0) and (i // 10 != xmax) and (i % 10 != 0) and (i % 10 != xmax):  # Example 12
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.75
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.1
            elif (i % 10 == 0) and (i // 10 != 0) and (i // 10 != xmax):  # Example 80
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.05
                TPMdummy[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) + 1] = 0.4
            elif (i % 10 == xmax) and (i // 10 != 0) and (i // 10 != xmax):  # Example 59
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10) - 1] = 0.05
                TPMacl[a][(i // 10) * 10 + (i % 10)][(i // 10) * 10 + (i % 10)] = 0.75
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) + 1) * 10 + (i % 10)] = 0.1
                TPMacl[a][(i // 10) * 10 + (i % 10)][((i // 10) - 1) * 10 + (i % 10)] = 0.1
TPM1 = np.concatenate((TPMcl, TPMdummy), axis=2)
TPM2 = np.concatenate((TPMdummy, TPMacl), axis=2)
TPM = np.concatenate((TPM1, TPM2), axis=1)   # The final transition probability matrix

#print(TPM[0][100])